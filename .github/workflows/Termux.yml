# .github/workflows/deploy-termux.yml
name: üöÄ BeltahBot Termux Deploy

on:
  push:
    branches: [ "main" ]          # run on every push to main
  workflow_dispatch:              # allow manual trigger from the Actions tab

jobs:
  build-artifact:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      actions: write               # needed for upload-artifact

    steps:
      # 1Ô∏è‚É£ Check out the repo
      - uses: actions/checkout@v4
        with:
          fetch-depth: 1           # faster, we don‚Äôt need full history

      # 2Ô∏è‚É£ (Optional) clean up things that don‚Äôt belong in the archive
      - name: üßπ Clean temp folders
        run: |
          rm -rf ./test ./logs || true

      # 3Ô∏è‚É£ Create a tarball **outside** the repo folder to avoid recursion
      - name: üì¶ Create deploy archive
        run: |
          cd ${{ github.workspace }}
          tar  --exclude='.git' \
               --exclude='node_modules' \
               -czf beltahbot-md.tar.gz .

      # 4Ô∏è‚É£ Upload the artefact so you can pull it from Termux/Tamax
      - name: ‚¨ÜÔ∏è  Upload deploy artefact
        uses: actions/upload-artifact@v4
        with:
          name: beltahbot-md
          path: beltahbot-md.tar.gz
